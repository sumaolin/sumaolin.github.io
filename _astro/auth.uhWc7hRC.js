import{O as n,c as t,s as i,g as c,U as u}from"./storage.1FXeSNfh.js";const l=()=>{const o=c();if(o)return p(o.token),o},p=async o=>{const r=new n({auth:o}),{data:s}=await r.request("GET /user"),{data:e}=await r.request("GET /repos/{owner}/{repo}",{owner:t.github.login,repo:t.github.repo}).catch(a=>(console.error(a),{data:{permissions:{}}}));if(!e.permissions?.push)throw new Error("login user has no permission to push to current repo");i({name:s.name??"",avatar:s.avatar_url,login:s.login,token:o,permissions:e.permissions})},m=()=>{localStorage.removeItem(u)};export{m as a,l as g,p as l};
